function SubmitImport(n,t){var r=document.getElementById("importSelect"),u=r.options[r.selectedIndex].text,f=document.getElementById("file"),i=new FormData,e=f.files[0];i.append("file",e);i.append("source",u);$.ajax({url:n,processData:!1,contentType:!1,data:i,type:"POST",success:function(n){n?(alert("Import succeded!"),window.location.href=t):n?alert("Error!"):alert("Import failed!")}})}function SubmitExport(n){for(var f,i=document.getElementById("exportSelect"),e=i.options[i.selectedIndex].text,o=document.getElementById("search").value,r=$(".SelectedRow"),u="",t=0;t<r.length;t++)u+=r[t].cells[2].innerHTML+" ";f=n.replace("_exportType_",e).replace("_searchValue_",o).replace("_selection_",u);window.location=f}function PreventDoubleClick(){var n=document.getElementById("table");n.addEventListener("mousedown",function(n){var t,i;n.detail>1&&n.ctrlKey==!1?n.preventDefault():n.ctrlKey&&(n.preventDefault(),t=$(n.target).closest("tr"),t.hasClass("SelectedRow")?t.removeClass("SelectedRow"):t.addClass("SelectedRow"),i=$(".SelectedRow"),document.getElementById("selectionButtons").style.display=i.length>0?"":"none")},!1)}$("#ParentRow > td").hover(function(){$(this).find("th").length>0||$(this).addClass("gridRowHover")},function(){$(this).removeClass("gridRowHover")});$("table").click(function(n){if(window.getSelection().type=="Caret"&&(n.stopPropagation(),n.ctrlKey==!1)){var t=$(n.target),i=$(n.target).closest("tr").next("tr");t.closest("tr").attr("id")=="toprow"&&(t.closest("tr").next("tr").is(":visible")?i.slideUp("fast"):i.slideToggle("fast"))}});$("#selectionExport").click(function(){$.getScript("/js/ConfirmationDialogue.js",function(){ConfirmClickGeneric(Export,"#exportDialog")})});$("#selectionDelete").click(function(){for(var u=document.getElementById("deleteTable"),i=$(".SelectedRow"),t=0;t<i.length;t++){var f=i[t].cells[1].innerHTML,e=i[t].cells[2].innerHTML,o=i[t].cells[3].innerHTML,r=document.createElement("tr"),n=document.createElement("td");n.innerHTML=f;r.append(n);n=document.createElement("td");n.innerHTML=e;r.append(n);n=document.createElement("td");n.innerHTML=o;r.append(n);u.appendChild(r)}$.getScript("/js/ConfirmationDialogue.js",function(){ConfirmClickGeneric(Delete,"#deleteDialog",900)})});